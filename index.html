<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Backgammon Jahr 2025</title>
<style>
  body { font-family: Arial; text-align:center; margin:20px; }
  h1 { font-size:2em; }
  .player { margin: 20px; }
  .striche { font-size: 2em; letter-spacing:10px; }
  button { font-size:1em; padding:5px 10px; margin:5px; }
</style>
</head>
<body>

<h1>Backgammon Jahr 2025</h1>
<h2 id="countdown">Die Uhr Tickt..bald zweiter Geburtstag</h2>

<div class="player">
  <h3>Muli</h3>
  <div id="muli" class="striche"> </div>
  <button onclick="addPoint('muli')">+1</button>
</div>

<div class="player">
  <h3>Rinora</h3>
  <div id="rinora" class="striche"> </div>
  <button onclick="addPoint('rinora')">+1</button>
</div>

<!-- Firebase SDK via Module -->
<script type="module">
  // ----- Import der SDK-Funktionen -----
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-app.js";
  import { getDatabase, ref, onValue, runTransaction } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-database.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-analytics.js";

  // ----- Firebase Konfiguration -----
  const firebaseConfig = {
    apiKey: "AIzaSyXne9JncLUdMtDLq0WIpQg_k-aegkTZQ",
    authDomain: "spiel-db95f.firebaseapp.com",
    projectId: "spiel-db95f",
    storageBucket: "spiel-db95f.firebasestorage.app",
    messagingSenderId: "895764009420",
    appId: "1:895764009420:web:4b41b5a8921accf3d74d69",
    measurementId: "G-BWDTKVZNZK"
  };

  // ----- Initialize Firebase -----
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getDatabase(app);

  // ----- State -----
  let scores = { muli:0, rinora:0 };

  // ----- Realtime Listener -----
  const scoresRef = ref(db, 'scores');
  onValue(scoresRef, snapshot => {
    scores = snapshot.val() || { muli:0, rinora:0 };
    render();
  });

  // ----- Render Strichliste -----
  function render() {
    document.getElementById('muli').textContent = getStriche(scores.muli);
    document.getElementById('rinora').textContent = getStriche(scores.rinora);
  }

  function getStriche(n) {
    let result = '';
    for(let i=1; i<=n; i++){
      result += '|';
      if(i%5===0) result += ' '; // 5er Gruppe optisch trennen
    }
    return result;
  }

  // ----- Punkte hinzufügen mit Passwort -----
  window.addPoint = function(player) {
    const pwMuli = prompt("Passwort für Muli:");
    if(pwMuli !== "muli123") { alert("Falsches Passwort!"); return; }
    const pwRinora = prompt("Passwort für Rinora:");
    if(pwRinora !== "rinora123") { alert("Falsches Passwort!"); return; }

    const playerRef = ref(db, 'scores/' + player);
    runTransaction(playerRef, current => (current||0)+1);
  }

  // ----- Countdown -----
  function updateCountdown() {
    const now = new Date();
    const newYear = new Date('2026-01-01T00:00:00');
    let diff = newYear - now;
    if(diff<0) diff=0;
    const days = Math.floor(diff/1000/60/60/24);
    const hours = Math.floor((diff/1000/60/60)%24);
    const mins = Math.floor((diff/1000/60)%60);
    const secs = Math.floor((diff/1000)%60);
    document.getElementById('countdown').textContent =
      `Die Uhr Tickt..bald zweiter Geburtstag: ${days}d ${hours}h ${mins}m ${secs}s`;
  }
  setInterval(updateCountdown,1000);
  updateCountdown();

</script>
</body>
</html>
